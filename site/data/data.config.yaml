- task: slugify
  dataset: examples.movies
  input_col: name_en
  output_col: movie_slug

- task: aggregate
  dataset: examples.movies
  type: count_u
  group_by: year
  input_col: name_en
  output_col: movies_year

- task: del_cols
  dataset: examples.movies
  cols: ["minutes_long", "budget", "rating_metacritic"]

- task: number
  dataset: examples.movies
  cols: ["rating_metacritic"]

# render russian
- task: render
  dataset: examples.movies
  type: row
  path: /ru/examples/movies/[movie_slug].html
  meta:
    title: "[name_ru]"
    group: movies
    excerpt: "Компания _[company]_, режиссер — [director_ru], [year] год."
  markdown: |-
    - Компания: **[company]**
    - Режиссер: **[director_ru]**
    - Год выхода: [ **[year]** ](/ru/examples/years/[year].html)
    - Рейтинг IMDB: **[rating_IMDB]**

- task: render
  dataset: examples.movies
  type: col
  col: year
  path: /ru/examples/years/[year].html
  meta:
    title: "[year]"
    croup: years
    excerpt: "Вышло фильмов: [movies_year]"
  markdown: |-
    {% for row in page.local_data %}
    - {{row.company}} : [{{ row.name_ru }}](/ru/examples/movies/{{row.movie_slug}}.html)
    {% endfor %}
    {{ saveData("test" , page.local_data) }}

# render english
- task: render
  dataset: examples.movies
  type: row
  path: /en/examples/movies/[movie_slug].html
  meta:
    title: "[name_en]"
    group: movies
    excerpt: "Company: _[company]_, director: — [director_en], [year] year."
  markdown: |-
    - Company: **[company]**
    - Director: **[director_en]**
    - Year: [ **[year]** ](/en/examples/years/[year].html)
    - IMDB: **[rating_IMDB]**

- task: render
  dataset: examples.movies
  type: col
  col: year
  path: /en/examples/years/[year].html
  meta:
    title: "[year]"
    croup: years
    excerpt: "Movies: [movies_year]"
  markdown: |-
    {% for row in page.local_data %}
    - {{row.company}} : [{{ row.name_en }}](/en/examples/movies/{{row.movie_slug}}.html)
    {% endfor %}
    {{ saveData("test" , page.local_data) }}

- task: render
  type: key
  dataset: keys
  path: /en/examples/chars/[key].html
  meta:
    title: "Ice And Fire, [key]"
  markdown: |-
    {{ page.local_data.name}}
    ========================

    - Gender: **{{page.local_data.gender}}**
    - API URL: **{{page.local_data.url}}**

- task: render
  type: key
  dataset: keys
  path: /ru/examples/chars/[key].html
  meta:
    title: "Ice And Fire, [key]"
  markdown: |-
    {{ page.local_data.name}}
    ========================

    - Gender: **{{page.local_data.gender}}**
    - API URL: **{{page.local_data.url}}**
